{
    "type": "object",
    "required": [
        "alias",
        "source",
        "thread_id",
        "packet_id",
        "daemon_event_id",
        "daemon_event_name"
    ],
    "if": {
        "properties": { "daemon_event_name": { "const": "init" } }
    },
    "then": {
        "required": [ "max-flows-per-thread", "max-idle-flows-per-thread", "tick-resolution", "reader-thread-count", "flow-scan-interval", "generic-max-idle-time", "icmp-max-idle-time", "udp-max-idle-time", "tcp-max-idle-time", "max-packets-per-flow-to-send", "max-packets-per-flow-to-process" ]
    },
    "if": {
        "properties": { "daemon_event_name": { "const": "shutdown" } }
    },
    "then": {
        "required": [ "total-events-serialized" ]
    },
    "properties": {
        "alias": {
            "type": "string"
        },
        "source": {
            "type": "string"
        },
        "thread_id": {
            "type": "number",
            "minimum": 0,
            "maximum": 31
        },
        "packet_id": {
            "type": "number",
            "minimum": 0
        },
        "daemon_event_id": {
            "type": "number",
            "minimum": 0,
            "maximum": 3
        },
        "daemon_event_name": {
            "type": "string",
            "enum": [
                "invalid",
                "init",
                "reconnect",
                "shutdown"
            ]
        },
        "max-flows-per-thread": {
            "type": "number"
        },
        "max-idle-flows-per-thread": {
            "type": "number"
        },
        "tick-resolution": {
            "type": "number"
        },
        "reader-thread-count": {
            "type": "number"
        },
        "flow-scan-interval": {
            "type": "number"
        },
        "generic-max-idle-time": {
            "type": "number"
        },
        "icmp-max-idle-time": {
            "type": "number"
        },
        "udp-max-idle-time": {
            "type": "number"
        },
        "tcp-max-idle-time": {
            "type": "number"
        },
        "max-packets-per-flow-to-process": {
            "type": "number"
        },
        "max-packets-per-flow-to-send": {
            "type": "number"
        },
        "total-events-serialized": {
            "type": "number",
            "minimum": 1
        }
    },
    "additionalProperties": false
}
